
<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>Admin Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-50 font-sans p-6">
  <h1 class="text-2xl font-bold mb-4">ЁЯЫа Admin Dashboard</h1>

  <!-- MENU -->
  <div class="grid grid-cols-2 gap-3 mb-6 text-sm">
    <button onclick="showTab('event')" class="bg-blue-600 text-white py-2 rounded">р╕Бр╕┤р╕Ир╕Бр╕гр╕гр╕б</button>
    <button onclick="showTab('item')" class="bg-green-600 text-white py-2 rounded">р╕Вр╕нр╕Зр╣Бр╕ер╕Б</button>
    <button onclick="showTab('point')" class="bg-purple-600 text-white py-2 rounded">р╣Бр╕Хр╣Йр╕б</button>
    <button onclick="showTab('user')" class="bg-yellow-600 text-white py-2 rounded">р╕кр╕бр╕▓р╕Кр╕┤р╕Б</button>
  </div>

  <!-- EVENT -->
  <div id="tab-event" class="hidden">
    <h2 class="font-bold text-lg mb-2">ЁЯУв р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Бр╕┤р╕Ир╕Бр╕гр╕гр╕б</h2>
    <input id="eventTitle" placeholder="р╕Кр╕╖р╣Ир╕нр╕Бр╕┤р╕Ир╕Бр╕гр╕гр╕б" class="w-full p-2 border mb-2 rounded">
    <input id="eventPoint" type="number" placeholder="р╣Бр╕Хр╣Йр╕б" class="w-full p-2 border mb-2 rounded">
    <textarea id="eventDesc" placeholder="р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Ф" class="w-full p-2 border mb-2 rounded"></textarea>
    <input id="eventImage" placeholder="URL р╕гр╕╣р╕Ыр╕ар╕▓р╕Ю (р╣Др╕бр╣Ир╕Ър╕▒р╕Зр╕Др╕▒р╕Ъ)" class="w-full p-2 border mb-2 rounded">
    <button onclick="addEvent()" class="bg-blue-700 text-white py-2 px-4 rounded">тЮХ р╣Ар╕Юр╕┤р╣Ир╕бр╕Бр╕┤р╕Ир╕Бр╕гр╕гр╕б</button>
  </div>

  <!-- ITEM -->
  <div id="tab-item" class="hidden">
    <h2 class="font-bold text-lg mb-2">ЁЯОБ р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Вр╕нр╕Зр╣Бр╕ер╕Б</h2>
    <input id="itemName" placeholder="р╕Кр╕╖р╣Ир╕нр╕Вр╕нр╕З" class="w-full p-2 border mb-2 rounded">
    <input id="itemPoint" type="number" placeholder="р╣Бр╕Хр╣Йр╕бр╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╣Бр╕ер╕Б" class="w-full p-2 border mb-2 rounded">
    <input id="itemImage" placeholder="URL р╕гр╕╣р╕Ыр╕ар╕▓р╕Ю (р╣Др╕бр╣Ир╕Ър╕▒р╕Зр╕Др╕▒р╕Ъ)" class="w-full p-2 border mb-2 rounded">
    <button onclick="addItem()" class="bg-green-700 text-white py-2 px-4 rounded">тЮХ р╣Ар╕Юр╕┤р╣Ир╕бр╕Вр╕нр╕Зр╣Бр╕ер╕Б</button>
  </div>

  <!-- POINT -->
  <div id="tab-point" class="hidden">
    <h2 class="font-bold text-lg mb-2">ЁЯОп р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╣Бр╕Хр╣Йр╕б</h2>
    <input id="targetLineId" placeholder="LINE ID р╕Ьр╕╣р╣Йр╣Гр╕Кр╣Й" class="w-full p-2 border mb-2 rounded">
    <input id="pointAmount" type="number" placeholder="р╕Ир╕│р╕Щр╕зр╕Щр╣Бр╕Хр╣Йр╕б" class="w-full p-2 border mb-2 rounded">
    <input id="pointNote" placeholder="р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕" class="w-full p-2 border mb-2 rounded">
    <div class="grid grid-cols-2 gap-2">
      <button onclick="adjustPoint('add')" class="bg-purple-700 text-white py-2 rounded">тЮХ р╣Бр╕Ир╕Бр╣Бр╕Хр╣Йр╕б</button>
      <button onclick="adjustPoint('subtract')" class="bg-red-600 text-white py-2 rounded">тЮЦ р╕лр╕▒р╕Бр╣Бр╕Хр╣Йр╕б</button>
    </div>
  </div>

  <!-- USER -->
  <div id="tab-user" class="hidden">
    <h2 class="font-bold text-lg mb-2">ЁЯСд р╕кр╕бр╕▓р╕Кр╕┤р╕Б (р╕Фр╕╣р╕нр╕вр╣Ир╕▓р╕Зр╣Ар╕Фр╕╡р╕вр╕з)</h2>
    <button onclick="loadUsers()" class="bg-yellow-700 text-white py-2 px-4 rounded mb-2">ЁЯФД р╣Вр╕лр╕ер╕Фр╕кр╕бр╕▓р╕Кр╕┤р╕Б</button>
    <div id="userList" class="text-sm bg-white p-3 rounded shadow"></div>
  </div>

  <script>
    const url = 'https://script.google.com/macros/s/AKfycbz-i__HSZ02gYgSP_3bqIi_sURADUEWCa6UW1ajYiuPdVF_2QW8ZU9oDSCPBfLgRsGK/exec'; // <== р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Ар╕Ыр╣Зр╕Щр╕Вр╕нр╕Зр╕Др╕╕р╕У

    function showTab(tab) {
      ['event', 'item', 'point', 'user'].forEach(id =>
        document.getElementById('tab-' + id).classList.add('hidden')
      );
      document.getElementById('tab-' + tab).classList.remove('hidden');
    }

    async function addEvent() {
      const body = {
        action: 'addEvent',
        title: eventTitle.value,
        point: eventPoint.value,
        desc: eventDesc.value,
        image: eventImage.value
      };
      const res = await fetch(url, {
        method: 'POST',
        body: JSON.stringify(body)
      });
      Swal.fire("р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М", await res.text(), "success");
    }

    async function addItem() {
      const body = {
        action: 'addItem',
        name: itemName.value,
        point: itemPoint.value,
        image: itemImage.value
      };
      const res = await fetch(url, {
        method: 'POST',
        body: JSON.stringify(body)
      });
      Swal.fire("р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М", await res.text(), "success");
    }

    async function adjustPoint(mode) {
      const body = {
        action: 'adjustPoint',
        lineId: targetLineId.value,
        amount: pointAmount.value,
        note: pointNote.value,
        mode
      };
      const res = await fetch(url, {
        method: 'POST',
        body: JSON.stringify(body)
      });
      Swal.fire("р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М", await res.text(), "success");
    }

    async function loadUsers() {
      const res = await fetch(url + '?action=getUsers');
      const users = await res.json();
      const html = users.map(u =>
        `<div class="border-b py-2"><b>${u.name}</b> (${u.phone}) - ${u.point} р╣Бр╕Хр╣Йр╕б</div>`
      ).join('');
      document.getElementById("userList").innerHTML = html;
    }
  </script>
</body>
</html>
